<link rel="import" href="../../../bower_components/polymer/polymer.html">

<dom-module id="app-selection">
<style>

    :host {
      display: block;
      color: #123D5A;
  }

  html, body, div, span, applet, object, iframe,
  h1, h2, h3, h4, h5, h6, p, blockquote, pre,
  a, abbr, acronym, address, big, cite, code,
  del, dfn, em, img, ins, kbd, q, s, samp,
  small, strike, strong, sub, sup, tt, var,
  b, u, i, center,
  dl, dt, dd, ol, ul, li,
  fieldset, form, label, legend,
  table, caption, tbody, tfoot, thead, tr, th, td,
  article, aside, canvas, details, embed, 
  figure, figcaption, footer, header, hgroup, 
  menu, nav, output, ruby, section, summary,
  time, mark, audio, video {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
  }
  /* HTML5 display-role reset for older browsers */
  article, aside, details, figcaption, figure, 
  footer, header, hgroup, menu, nav, section {
    display: block;
  }
  body {
    line-height: 1;
  }
  ol, ul {
    list-style: none;
  }
  blockquote, q {
    quotes: none;
  }
  blockquote:before, blockquote:after,
  q:before, q:after {
    content: '';
    content: none;
  }
  table 
  {
    border-collapse: collapse;
    border-spacing: 0;
  }

::host {
	display: block;
}

.container {
	color: white;
	background-color: #638fa6;

}

.container h1 {
	font-size: 2em;
}

.container h2 {
	font-size: 1.5em;
}

iron-icon {
	display: block;
	transition: opacity 0.3s;
}

iron-icon.selected {
	opacity: 0.5;
}

</style>
<template>
<div class='container'>
    <section>
      <h1>Critères selectionnés</h1>
      <h2>Précisez le degré d'importance</h2>
		<template id='criterias' is='dom-repeat' items='{{selected}}'>
			<span>{{item.icon}}</span>
		</template>
	</section>

	<section>
		<h2>Modifiez vos critères</h2>
		<iron-selector selected-class='selected' selectable='iron-icon'>
	    	<iron-icon icon='criterias:theatre'></iron-icon></li>
	        <iron-icon icon='criterias:music'></iron-icon></li>
	        <iron-icon icon='criterias:cinema'></iron-icon></li>
	        <iron-icon icon='criterias:monument'></iron-icon></li>
	        <iron-icon icon='criterias:food'></iron-icon></li>
	        <iron-icon icon='criterias:castle'></iron-icon></li>
	        <iron-icon icon='criterias:book'></iron-icon></li>
	        <iron-icon icon='criterias:people'></iron-icon></li>
	        <iron-icon icon='criterias:cocktail'></iron-icon></li>
	        <iron-icon icon='criterias:enceinte'></iron-icon></li>
	        <array-selector id='selector' items='{{criterias}}' selected="{{selected}}" multi toggle></array-selector>
        </iron-selector>
	</section>

</div>
</template>

<script>
	Polymer({
	    is: 'app-selection',
	    properties: {
	    	'criterias': {
	    		type: Array,
        		value: function() { return []; }
        	}
	    },
  		attached: function() {
  			var selector = Polymer.dom(this.root).querySelector('iron-selector');
  			selector.multi = true;
			selector.selectedValues = [];    //  ???????????????????????????????????????????? //

  			selector._toggleSelected = function(value) {
		      var i = this.selectedValues.indexOf(value);
		      var unselected = i < 0;
		      if (unselected) {
		      	if (this.selectedValues.length >= 3) { return; };
	        	this.selectedValues.push(value);
		      	Polymer.dom(this.root).querySelector('#selector').select(this._valueToItem(value));
		      	if (this.selectedValues.length == 3) {
		      		this.fire('hehe!!!!!!!!!!!!!!');
		      	}
		      } else {
		        this.selectedValues.splice(i, 1);
   		      	Polymer.dom(this.root).querySelector('#selector').deselect(this._valueToItem(value));
		      }
		      this._selection.setItemSelected(this._valueToItem(value), unselected);
		    }.bind(selector);
		}
	});
</script>
</dom-module>
