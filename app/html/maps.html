<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

	<link rel="stylesheet" href="assets/css/reset.css">
	<link rel="stylesheet" href="assets/css/maps.css">
	<title>Map</title>
</head>
<body>
	<div id="content">
			<map></map>
	</div>

	<script>		
		window.onload = function(){

			var width    = 950;
			var height   = 500;
			var mapColor = 'white';

			var canvas = d3.select('map')
				.append("svg")
				.attr("width", width)
				.attr("height", height);

			var projection = d3.geo.mercator().center([-0.6, 28.7]).rotate([-12,0]).scale(110);

			d3.json('world.geo.json', function(data) {

				var group = canvas.selectAll("g")
					.data(data.features)
					.enter()
					.append("g");

				group.append("path")
					.attr('d', d3.geo.path().projection(projection))
					.attr('stroke', mapColor)
					.attr('fill', mapColor);
			});

			d3.json("cities.geo.json", function(data) {
				var group = canvas.selectAll('svg')
					.data(data.features)
					.enter()
					.append('g')
					.attr('transform', function(d, i) {  return 'translate(' + projection(d.geometry.coordinates)[0] + ',' + projection(d.geometry.coordinates)[1] + ')'; });

				group
					.append('text')
					.text(function(d) { return d.properties.name; })
					.attr('font-size', 13)
					.attr('font-family', 'HelveticaNeue LightCond')
					.attr('opacity', 0.25)
					.attr("x", function(d) {
						return d.properties.offsetX;
					 })
					.attr("y", function(d) {
						return d.properties.offsetY;
					});

				var centroid = d3.geom.polygon([[97.3, 0], [127.4, 60.9], [194.6, 70.7], [145.9, 118.1], [157.4, 185.1], [97.3, 153.5], [37.2, 185.1], [48.6, 118.1], [0, 70.7], [67.2, 60.9]]).centroid();

				group
					.append('polygon')
					.attr('points', '97.3,0 127.4,60.9 194.6,70.7 145.9,118.1 157.4,185.1 97.3,153.5 37.2,185.1 48.6,118.1 0,70.7 67.2,60.9 ')
					.attr('transform', 'matrix(0.0573612,0,0,0.05721815,-0.0034523,0.00544948) translate(' + -centroid[0] + ', ' + -centroid[1] + ')')
					.attr('opacity', 0.5)
					.attr('fill', '#638fa6');
			});
		};
	</script>
</body>
</html>



